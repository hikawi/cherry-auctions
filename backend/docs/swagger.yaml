basePath: /v1
consumes:
- application/json
definitions:
  auth.LoginRequest:
    properties:
      email:
        type: string
      password:
        maxLength: 64
        minLength: 8
        type: string
    required:
    - email
    - password
    type: object
  auth.LoginResponse:
    properties:
      access_token:
        type: string
    type: object
  auth.RegisterRequest:
    properties:
      captcha_token:
        type: string
      email:
        type: string
      name:
        type: string
      password:
        maxLength: 64
        minLength: 8
        type: string
    required:
    - captcha_token
    - email
    - name
    - password
    type: object
  categories.CategoryDTO:
    properties:
      created_at:
        type: string
      deleted_at:
        type: string
      id:
        type: integer
      name:
        type: string
      parent_id:
        type: integer
      slug:
        type: string
      subcategories:
        description: To make Swagger not dig too deep
        items:
          type: object
        type: array
      updated_at:
        type: string
    type: object
  categories.PostCategoryBody:
    properties:
      name:
        maxLength: 200
        minLength: 2
        type: string
      parent_id:
        type: integer
    required:
    - name
    type: object
  categories.PutCategoryBody:
    properties:
      name:
        maxLength: 200
        minLength: 2
        type: string
      parent_id:
        type: integer
    required:
    - name
    type: object
  products.BidDTO:
    properties:
      automated:
        type: boolean
      bidder:
        $ref: '#/definitions/products.ProfileDTO'
      created_at:
        type: string
      id:
        type: integer
      price:
        type: integer
      updated_at:
        type: string
    type: object
  products.CategoryDTO:
    properties:
      id:
        type: integer
      name:
        type: string
      parent_id:
        type: integer
    type: object
  products.DescriptionChangeDTO:
    properties:
      changes:
        type: string
      created_at:
        type: string
      id:
        type: integer
    type: object
  products.GetProductDetailsResponse:
    properties:
      allows_unrated_buyers:
        type: boolean
      auto_extends_time:
        type: boolean
      bids:
        items:
          $ref: '#/definitions/products.BidDTO'
        type: array
      bids_count:
        type: integer
      bin_price:
        type: integer
      categories:
        items:
          $ref: '#/definitions/products.CategoryDTO'
        type: array
      created_at:
        type: string
      current_highest_bid:
        $ref: '#/definitions/products.BidDTO'
      denied_bidders:
        items:
          $ref: '#/definitions/products.ProfileDTO'
        type: array
      description:
        type: string
      description_changes:
        items:
          $ref: '#/definitions/products.DescriptionChangeDTO'
        type: array
      expired_at:
        type: string
      id:
        type: integer
      is_favorite:
        type: boolean
      name:
        type: string
      product_images:
        items:
          $ref: '#/definitions/products.ProductImageDTO'
        type: array
      questions:
        items:
          $ref: '#/definitions/products.QuestionDTO'
        type: array
      seller:
        $ref: '#/definitions/products.ProfileDTO'
      similar_products:
        items:
          $ref: '#/definitions/products.ProductDTO'
        type: array
      starting_bid:
        type: integer
      step_bid_value:
        type: integer
      thumbnail_url:
        type: string
    type: object
  products.GetProductsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/products.ProductDTO'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  products.GetTopProductsResponse:
    properties:
      ending_soon:
        items:
          $ref: '#/definitions/products.ProductDTO'
        type: array
      highest_bids:
        items:
          $ref: '#/definitions/products.ProductDTO'
        type: array
      top_bids:
        items:
          $ref: '#/definitions/products.ProductDTO'
        type: array
    type: object
  products.PostBidBody:
    properties:
      bid:
        type: integer
    required:
    - bid
    type: object
  products.PostDenyBidderBody:
    properties:
      user_id:
        type: integer
    required:
    - user_id
    type: object
  products.PostProductDescriptionBody:
    properties:
      description:
        minLength: 50
        type: string
    required:
    - description
    type: object
  products.ProductDTO:
    properties:
      allows_unrated_buyers:
        type: boolean
      auto_extends_time:
        type: boolean
      bids_count:
        type: integer
      bin_price:
        type: integer
      categories:
        items:
          $ref: '#/definitions/products.CategoryDTO'
        type: array
      created_at:
        type: string
      current_highest_bid:
        $ref: '#/definitions/products.BidDTO'
      denied_bidders:
        items:
          $ref: '#/definitions/products.ProfileDTO'
        type: array
      description:
        type: string
      description_changes:
        items:
          $ref: '#/definitions/products.DescriptionChangeDTO'
        type: array
      expired_at:
        type: string
      id:
        type: integer
      is_favorite:
        type: boolean
      name:
        type: string
      seller:
        $ref: '#/definitions/products.ProfileDTO'
      starting_bid:
        type: integer
      step_bid_value:
        type: integer
      thumbnail_url:
        type: string
    type: object
  products.ProductImageDTO:
    properties:
      alt:
        type: string
      url:
        type: string
    type: object
  products.ProfileDTO:
    properties:
      avatar_url:
        type: string
      average_rating:
        type: number
      email:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  products.QuestionDTO:
    properties:
      answer:
        type: string
      content:
        type: string
      created_at:
        type: string
      id:
        type: integer
      updated_at:
        type: string
      user:
        $ref: '#/definitions/products.ProfileDTO'
    type: object
  questions.PostQuestionBody:
    properties:
      content:
        minLength: 2
        type: string
      product_id:
        type: integer
    required:
    - content
    - product_id
    type: object
  questions.PutQuestionBody:
    properties:
      answer:
        minLength: 2
        type: string
    required:
    - answer
    type: object
  shared.ErrorResponse:
    properties:
      error:
        type: string
    type: object
  shared.MessageResponse:
    properties:
      message:
        type: string
    type: object
  users.BidDTO:
    properties:
      automated:
        type: boolean
      bidder:
        $ref: '#/definitions/users.ProfileDTO'
      created_at:
        type: string
      id:
        type: integer
      price:
        type: integer
      updated_at:
        type: string
    type: object
  users.CategoryDTO:
    properties:
      id:
        type: integer
      name:
        type: string
      parent_id:
        type: integer
    type: object
  users.DescriptionChangeDTO:
    properties:
      changes:
        type: string
      created_at:
        type: string
      id:
        type: integer
    type: object
  users.GetProductsResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/users.ProductDTO'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  users.GetUsersResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/users.UserDTO'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  users.PostAvatarResponse:
    properties:
      avatar_url:
        type: string
    type: object
  users.PostProfileRequest:
    properties:
      address:
        minLength: 2
        type: string
      name:
        maxLength: 200
        minLength: 2
        type: string
    type: object
  users.ProductDTO:
    properties:
      allows_unrated_buyers:
        type: boolean
      auto_extends_time:
        type: boolean
      bids:
        items:
          $ref: '#/definitions/users.BidDTO'
        type: array
      bids_count:
        type: integer
      bin_price:
        type: integer
      categories:
        items:
          $ref: '#/definitions/users.CategoryDTO'
        type: array
      created_at:
        type: string
      current_highest_bid:
        $ref: '#/definitions/users.BidDTO'
      denied_bidders:
        items:
          $ref: '#/definitions/users.ProfileDTO'
        type: array
      description:
        type: string
      description_changes:
        items:
          $ref: '#/definitions/users.DescriptionChangeDTO'
        type: array
      expired_at:
        type: string
      id:
        type: integer
      is_favorite:
        type: boolean
      name:
        type: string
      seller:
        $ref: '#/definitions/users.ProfileDTO'
      starting_bid:
        type: integer
      step_bid_value:
        type: integer
      thumbnail_url:
        type: string
    type: object
  users.ProfileDTO:
    properties:
      avatar_url:
        type: string
      average_rating:
        type: number
      email:
        type: string
      id:
        type: integer
      name:
        type: string
    type: object
  users.SubscriptionDTO:
    properties:
      created_at:
        type: string
      expired_at:
        type: string
    type: object
  users.UserDTO:
    properties:
      address:
        type: string
      avatar_url:
        type: string
      average_rating:
        type: number
      created_at:
        type: string
      email:
        type: string
      id:
        type: integer
      name:
        type: string
      roles:
        items:
          type: string
        type: array
      subscription:
        $ref: '#/definitions/users.SubscriptionDTO'
      verified:
        type: boolean
      waiting_approval:
        type: boolean
    type: object
info:
  contact:
    email: hello@luny.dev
    name: Nguyệt Ánh
  description: Backend API for CherryAuctions at cherry-auctions.luny.dev.
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  title: Cherry Auctions API
  version: "1.0"
paths:
  /auth/login:
    post:
      consumes:
      - application/json
      description: Logins to an account using a username and a password registered
        with the server.
      parameters:
      - description: Login credentials
        in: body
        name: credentials
        required: true
        schema:
          $ref: '#/definitions/auth.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Login successful
          schema:
            $ref: '#/definitions/auth.LoginResponse'
        "400":
          description: Bad username or password format
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Wrong password
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: Account is not verified
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: Account does not exist
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "421":
          description: Account uses oauth but tries to login with password
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: Server couldn't complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Logins to an existing account
      tags:
      - authentication
  /auth/logout:
    post:
      description: Logouts, and also invalidates the refresh token. This does not
        revoke access tokens.
      responses:
        "204":
          description: Any request, regardless of authentication status
          schema:
            $ref: '#/definitions/shared.MessageResponse'
      summary: Logouts and invalidates the refresh token if available.
      tags:
      - authentication
  /auth/refresh:
    post:
      description: Uses the provided refresh token cookie to refresh on another short-lived
        access token.
      responses:
        "200":
          description: Refreshed successfully
          schema:
            $ref: '#/definitions/auth.LoginResponse'
        "401":
          description: Did not attach refresh token
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Refreshs a JWT key pair.
      tags:
      - authentication
  /auth/register:
    post:
      consumes:
      - application/json
      description: Registers a new account with the system using a email-password
        pair.
      parameters:
      - description: Register credentials
        in: body
        name: credentials
        required: true
        schema:
          $ref: '#/definitions/auth.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: User was successfully registered
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Request body is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: Captcha failed
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "409":
          description: An account with that email already exists
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Registers a new account
      tags:
      - authentication
  /auth/verify:
    post:
      description: Requests the server to send an OTP code for verification.
      responses:
        "200":
          description: An OTP code has been sent
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "204":
          description: Already verified
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "401":
          description: User is unauthenticated
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/shared.MessageResponse'
      summary: Requests an OTP code for verification.
      tags:
      - authentication
  /auth/verify/check:
    post:
      description: Verifies a user's OTP code.
      responses:
        "200":
          description: Verification successfully
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Failed to verify
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Not logged in
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "422":
          description: Token is valid but user does not exist
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Verifies an OTP code.
      tags:
      - authentication
  /categories:
    get:
      description: This endpoint retrieves all categories in a fully recursive nested
        list, for easily displaying on the frontend.
      produces:
      - application/json
      responses:
        "200":
          description: List was successfully fetched
          schema:
            items:
              $ref: '#/definitions/categories.CategoryDTO'
            type: array
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Retrieves a recursively nested list of categories.
      tags:
      - categories
    post:
      consumes:
      - application/json
      parameters:
      - description: New category data
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/categories.PostCategoryBody'
      produces:
      - application/json
      responses:
        "201":
          description: Category was successfully created
          schema:
            $ref: '#/definitions/categories.CategoryDTO'
        "400":
          description: Category body data was invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: Not enough permissions
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Creates a category
      tags:
      - categories
  /categories/{id}:
    delete:
      description: Soft-deletes a category record by setting a flag.
      parameters:
      - description: Category ID
        format: int64
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "204":
          description: Category was deleted
        "400":
          description: Category body data was invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: Not enough permissions
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: Category could not be found
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Soft-delete a category record
      tags:
      - categories
    put:
      consumes:
      - application/json
      description: Update a category records by updating it partially
      parameters:
      - description: Category ID
        format: int64
        in: path
        name: id
        required: true
        type: integer
      - description: New updated category data
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/categories.PutCategoryBody'
      produces:
      - application/json
      responses:
        "200":
          description: Category was successfully changed, returns old category
          schema:
            $ref: '#/definitions/categories.CategoryDTO'
        "400":
          description: Category body data was invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: Not enough permissions
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: Category could not be found
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Update a category record
      tags:
      - categories
  /health:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: Always
          schema:
            $ref: '#/definitions/shared.MessageResponse'
      summary: Checks health of the server.
      tags:
      - others
  /products:
    get:
      description: Queries from a list of products using a set of keywords, using
        Full-text Queries or Fuzzy and Similarity queries.
      parameters:
      - description: Search Categories
        in: query
        name: category
        type: array
      - description: Sort Type
        in: query
        name: sort
        type: string
      - description: Sort Direction
        in: query
        name: asc
        type: boolean
      - description: Search Query
        in: query
        name: query
        type: string
      - description: Page Number
        in: query
        name: page
        type: integer
      - description: Items per Page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/products.GetProductsResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Queries products using fuzzy matchers and full-text matchers.
      tags:
      - products
    post:
      consumes:
      - multipart/form-data
      description: Posts a new product up for auctions.
      parameters:
      - description: Product Name
        in: formData
        minLength: 2
        name: name
        required: true
        type: string
      - description: Product Description
        in: formData
        minLength: 50
        name: description
        required: true
        type: string
      - description: Initial bid amount
        in: formData
        minimum: 1
        name: starting_bid
        required: true
        type: integer
      - collectionFormat: csv
        description: Array of category IDs
        in: formData
        items:
          type: integer
        name: categories
        required: true
        type: array
      - description: Product images to upload
        in: formData
        name: product_images
        required: true
        type: file
      - description: Minimum bid increment
        in: formData
        minimum: 1
        name: step_bid_value
        required: true
        type: integer
      - description: Buy It Now price
        in: formData
        minimum: 1
        name: bin_price
        type: integer
      - description: Allow unrated users to bid
        in: formData
        name: allows_unrated
        type: boolean
      - description: Extend auction on late bids
        in: formData
        name: auto_extends
        type: boolean
      - description: Expiration date (RFC3339)
        format: date-time
        in: formData
        name: expired_at
        required: true
        type: string
      produces:
      - application/json
      responses:
        "201":
          description: Successfully created an auction
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: When the multipart data is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When the user is unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: When the user isn't subscribed
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: The server couldn't find the requested product
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Posts a new product.
      tags:
      - products
  /products/{id}:
    get:
      description: Queries everything about a single product, with full joins.
      parameters:
      - description: Product ID to view
        in: path
        name: id
        required: true
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/products.GetProductDetailsResponse'
        "404":
          description: The server couldn't find the requested product
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Retrieves details on a single product.
      tags:
      - products
  /products/{id}/bids:
    delete:
      consumes:
      - application/json
      description: Removes all bidders from a product.
      produces:
      - application/json
      responses:
        "204":
          description: Successful removal
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Invalid ID
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: User is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: User is not the seller
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: Server could not finish the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Clears all bids on a product.
      tags:
      - products
    post:
      consumes:
      - application/json
      description: Bids on a product, hopefully with some race-condition management.
      parameters:
      - description: Bid body
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/products.PostBidBody'
      produces:
      - application/json
      responses:
        "201":
          description: Successful bid
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Bad request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: User is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: User can not bid for other reasons
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "409":
          description: Race condition, and you lost
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: Server could not finish the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Creates a bid on a product
      tags:
      - products
  /products/{id}/bin:
    post:
      consumes:
      - application/json
      description: Make a BIN bid to a product and end it immediately.
      produces:
      - application/json
      responses:
        "200":
          description: Successful bid
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Invalid ID
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: User is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: User is not the seller
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: Server could not finish the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Make a BIN purchase.
      tags:
      - products
  /products/{id}/denials:
    post:
      consumes:
      - application/json
      description: Deny a bidder from a current product.
      parameters:
      - description: Body
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/products.PostDenyBidderBody'
      produces:
      - application/json
      responses:
        "200":
          description: Successfully denied bidder
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Invalid bidder user ID
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: User is unauthorized or not verified
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: User is not seller, or denied bidder id is the seller
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: Product is not found
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "409":
          description: Bidder is already denied
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server couldn't complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Deny a bidder.
      tags:
      - products
  /products/{id}/description:
    post:
      consumes:
      - application/json
      description: The description can't be changed entirely, but there will be a
        post-script remark added to it.
      parameters:
      - description: Product ID
        in: path
        name: id
        required: true
        type: integer
      - description: New product description body
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/products.PostProductDescriptionBody'
      produces:
      - application/json
      responses:
        "201":
          description: Successfully added a postscript remark
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: When the request is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When the user is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: When the user can't edit a product or the product does not
            exist
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Posts a new product's description change.
      tags:
      - products
  /products/favorite:
    get:
      description: Queries on my favorite products,
      parameters:
      - description: Search Query
        in: query
        name: query
        type: string
      - description: Page Number
        in: query
        name: page
        type: integer
      - description: Items per Page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/products.GetProductsResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Retrieves my favorite products.
      tags:
      - products
    post:
      description: Mark a product as my favorite, if it is not a favorite, otherwise,
        unmark it.
      produces:
      - application/json
      responses:
        "204":
          description: No Content
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "404":
          description: Product could not be found
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Toggle a product as favorite.
      tags:
      - products
  /products/top:
    get:
      description: Queriee top-products via some metrics, instead of a pure query
        like /products.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/products.GetTopProductsResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      summary: Retrieves a list of products of top-categories.
      tags:
      - products
  /questions:
    post:
      consumes:
      - application/json
      description: Creates a new question to a product.
      parameters:
      - description: New question body
        in: body
        name: data
        required: true
        schema:
          $ref: '#/definitions/questions.PostQuestionBody'
      produces:
      - application/json
      responses:
        "201":
          description: Added a new question
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: When the request is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When the user is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: When the user is the seller or the product is expired
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Posts a question to a product.
      tags:
      - questions
  /questions/{id}:
    put:
      consumes:
      - application/json
      description: Answers a question to the product.
      parameters:
      - description: Question ID
        in: path
        name: id
        required: true
        type: integer
      - description: Question Body
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/questions.PutQuestionBody'
      produces:
      - application/json
      responses:
        "200":
          description: Added an answer
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: When the request is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When the user is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "403":
          description: When the user isn't the seller or the product is expired
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Answers a question.
      tags:
      - questions
  /users:
    get:
      description: Retrieves all users.
      produces:
      - application/json
      responses:
        "200":
          description: All users
          schema:
            $ref: '#/definitions/users.GetUsersResponse'
        "401":
          description: When unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Retrieves all users
      tags:
      - users
  /users/approve:
    post:
      description: Approves seller privileges
      produces:
      - application/json
      responses:
        "204":
          description: When success
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Approves seller privileges
      tags:
      - users
  /users/avatar:
    post:
      consumes:
      - multipart/form-data
      description: Uploads and changes my avatar.
      parameters:
      - description: account image
        in: formData
        name: avatar
        required: true
        type: file
      produces:
      - application/json
      - application/json
      responses:
        "200":
          description: When success
          schema:
            $ref: '#/definitions/users.PostAvatarResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "413":
          description: When the image is too big
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Changes my avatar.
      tags:
      - users
  /users/me:
    get:
      description: Retrieves information about your own profile if authenticated.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/users.UserDTO'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "422":
          description: When your info had an invalid state on the server
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Gets your own profile.
      tags:
      - users
    put:
      consumes:
      - application/json
      description: Updates the current authenticated user's profile
      parameters:
      - description: Profile data
        in: body
        name: profile
        required: true
        schema:
          $ref: '#/definitions/users.PostProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: When successfully changed
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "400":
          description: Invalid body
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When unauthorized
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Updates your user profile
      tags:
      - users
  /users/me/bids:
    get:
      description: Retrieves information about your ongoing bids.
      parameters:
      - description: Page Number
        in: query
        name: page
        type: integer
      - description: Items per Page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Successful
          schema:
            $ref: '#/definitions/users.GetProductsResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Gets my own bids.
      tags:
      - users
  /users/me/ended:
    get:
      description: Gets all auctions that are marked as ended.
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success
          schema:
            $ref: '#/definitions/users.GetProductsResponse'
        "400":
          description: Invalid query
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Gets my ended auctions.
      tags:
      - users
  /users/me/expired:
    get:
      description: Gets all auctions that are marked as expired.
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success
          schema:
            $ref: '#/definitions/users.GetProductsResponse'
        "400":
          description: Invalid query
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Gets my expired auctions.
      tags:
      - users
  /users/me/products:
    get:
      description: Retrieves my products, paginated.
      parameters:
      - description: Page Number
        in: query
        name: page
        type: integer
      - description: Items per Page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Successfully retrieved
          schema:
            $ref: '#/definitions/users.GetProductsResponse'
        "400":
          description: When the request is invalid
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: When the user is unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not make the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Retrieves my products
      tags:
      - users
  /users/me/ratings:
    get:
      description: Gets all ratings and related products and feedbacks, made by me.
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Success
          schema:
            $ref: '#/definitions/users.GetProductsResponse'
        "400":
          description: Invalid query
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "401":
          description: Unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The server could not complete the request
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Gets a list of ratings made by me.
      tags:
      - users
  /users/request:
    post:
      description: Sends a request to the admin to approve or deny seller privileges.
      produces:
      - application/json
      responses:
        "204":
          description: When success
          schema:
            $ref: '#/definitions/shared.MessageResponse'
        "401":
          description: When unauthenticated
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
        "500":
          description: The request could not be completed due to server faults
          schema:
            $ref: '#/definitions/shared.ErrorResponse'
      security:
      - ApiKeyAuth: []
      summary: Requests seller privileges
      tags:
      - users
produces:
- application/json
schemes:
- http
- https
securityDefinitions:
  ApiKeyAuth:
    description: Classic Bearer token, authenticated by using the login endpoint,
      which should grant an access token. To refresh it, use the RefreshToken cookie.
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
